{% extends 'admin/admin_base.html' %}
{% block extra_css %}
<style>
.badge {
  display: inline-block;
  padding: 6px 12px;
  font-size: 0.75rem;
  font-weight: 600;
  border-radius: 999px;
  text-transform: uppercase;
}

.badge-active {
  background-color: #198754;   /* Bootstrap green */
  color: #ffffff;
}

.badge-inactive {
  background-color: #dc3545;   /* Bootstrap red */
  color: #ffffff;
}
</style>
{% endblock %}
{% block content %}

  <!-- Main Content -->
  <main class="flex-fill p-4">
    <div class="container-fluid">

      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
        <h2 class="fw-bold">Categories</h2>
        <a class="btn btn-primary d-flex align-items-center gap-2" href="{%url 'add_category'%}">
          <span class="material-symbols-outlined">add</span>
          Add New Category
        </a>
      </div>

      <!-- Card -->
      <div class="card shadow-sm">

        <!-- Toolbar -->
        <div class="card-header bg-white d-flex justify-content-between align-items-center flex-wrap gap-3">
          <form method="get" class="d-flex gap-2 align-items-center">
            <input type="text" name="search" value="{{search}}" class="form-control" placeholder="search category name">
            <button class="btn btn-outline-secondary"><span class="material-symbols-outlined">search</span></button>
            </form>
          </div> 
          
        <!-- Table -->
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th>Category Name</th>
                <th>Category Type</th>
                <th>Products</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
  {% for category in page_obj %}
  <tr class="{% if category.parent %}table-light{% endif %}">

    <td class="fw-medium {% if category.parent %}ps-4{% endif %}">
      {{ category.name }}
    </td>

    <td>
      {% if category.parent %}
        Sub-category
      {% else %}
        Parent
      {% endif %}
    </td>

    <td>
      {{ category.active_product_count }}
    </td>

    <td>
      {% if category.is_active %}
        <span class="badge badge-active">Active</span>
      {% else %}
        <span class="badge badge-inactive">Inactive</span>
      {% endif %}
    </td>

    <td>
      <a href="{% url 'edit_category' category.id %}"
         class="text-primary fw-bold">
        Edit
      </a> 
      <form
    action="{% url 'delete_category' category.id %}"
    method="post"
    onsubmit="return confirm('Are you sure you want to delete this category?');"
  >
    {% csrf_token %}
    <button type="submit" class="btn btn-sm btn-outline-danger">
      Delete
    </button>
  </form>
    </td>
  </tr>
  {% empty %}
  <tr>
    <td colspan="6" class="text-center text-muted py-4">
      No categories found
    </td>
  </tr>
  {% endfor %}
</tbody>

          </table>
        </div>
     
        <!-- Pagination -->
        <div class="card-footer bg-white d-flex justify-content-center">
          <nav>
            <ul class="pagination mb-0">
  {% if page_obj.has_previous %}
    <li class="page-item">
      <a class="page-link" href="?page={{ page_obj.previous_page_number }}&search={{ search }}">&laquo;</a>
    </li>
  {% endif %}

  {% for num in page_obj.paginator.page_range %}
    {% if page_obj.number == num %}
      <li class="page-item active"><span class="page-link">{{ num }}</span></li>
    {% else %}
      <li class="page-item">
        <a class="page-link" href="?page={{ num }}&search={{ search }}">{{ num }}</a>
      </li>
    {% endif %}
  {% endfor %}

  {% if page_obj.has_next %}
    <li class="page-item">
      <a class="page-link" href="?page={{ page_obj.next_page_number }}&search={{ search }}">&raquo;</a>
    </li>
  {% endif %}
</ul>

          </nav>
        </div>

      </div>
    </div>
  </main>
{% endblock %}
